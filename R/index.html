<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="quarto-1.3.450">
    <meta name="author" content="Omar J. González">
    <meta name="dcterms.date" content="2023-11-08">
    
    <title>Proyecto valor agregado ICFES UCC</title>
    <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    </style>
    
    
    <script src="/R/clipboard.min.js"></script>
    <script src="/R/quarto.js"></script>
    <script src="/R/popper.min.js"></script>
    <script src="/R/tippy.umd.min.js"></script>
    <script src="/R/anchor.min.js"></script>
    <link href="/R/tippy.css" rel="stylesheet">
    <link href="/R/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
    <script src="R/bootstrap.min.js"></script>
    <link href="R/bootstrap-icons.css" rel="stylesheet">
    <link href="R/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
    
    
    <link rel="stylesheet" href="style.css">
    </head>
    
    <body>
    
    <div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
    <!--es la tabla de contenido -->  
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
      <nav id="TOC" role="doc-toc" class="toc-active">
        <h2 id="toc-title">Table of contents</h2>
       
      <ul>
      <li><a href="#capítulo-i-Introducción" id="toc-capítulo-i-Introducción" class="nav-link active" data-scroll-target="#capítulo-i-Introducción">CAPÍTULO I: Introducción</a>
      <ul class="collapse">
      <li><a href="#Modelos-VA" id="toc-Modelos-VA" class="nav-link" data-scroll-target="#Modelos-VA">Modelos de Valor Agregado</a>
      <!--Esta es una sub lista -->
        <ul class="collapse">
      <li><a href="#especificar-el-modelo" id="toc-especificar-el-modelo" class="nav-link" data-scroll-target="#especificar-el-modelo">1. Especificar el modelo</a></li>
      <li><a href="#estimar-el-modelo" id="toc-estimar-el-modelo" class="nav-link" data-scroll-target="#estimar-el-modelo">2. Estimar el modelo</a></li>
      <li><a href="#ver-los-resultados-del-modelo" id="toc-ver-los-resultados-del-modelo" class="nav-link" data-scroll-target="#ver-los-resultados-del-modelo">3. Ver los resultados del modelo</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#capítulo-ii-en-las-profundidades-de-los-datos" id="toc-capítulo-ii-en-las-profundidades-de-los-datos" class="nav-link" data-scroll-target="#capítulo-ii-en-las-profundidades-de-los-datos">CAPÍTULO II: En las Profundidades de los Datos</a>
      <ul class="collapse">
      <li><a href="#dividir-los-datos" id="toc-dividir-los-datos" class="nav-link" data-scroll-target="#dividir-los-datos">Dividir los datos</a></li>
      <li><a href="#estimar-el-modelo-1" id="toc-estimar-el-modelo-1" class="nav-link" data-scroll-target="#estimar-el-modelo-1">2. Estimar el modelo</a></li>
      <li><a href="#visualizar-los-resultados-del-modelo" id="toc-visualizar-los-resultados-del-modelo" class="nav-link" data-scroll-target="#visualizar-los-resultados-del-modelo">3. Visualizar los resultados del modelo</a></li>
      <li><a href="#evaluar-el-modelo" id="toc-evaluar-el-modelo" class="nav-link" data-scroll-target="#evaluar-el-modelo">4. Evaluar el modelo</a></li>
      <li><a href="#predicción-en-el-conjunto-completo-de-datos" id="toc-predicción-en-el-conjunto-completo-de-datos" class="nav-link" data-scroll-target="#predicción-en-el-conjunto-completo-de-datos">Predicción en el conjunto completo de datos</a></li>
      <li><a href="#métricas-para-evaluar-el-modelo" id="toc-métricas-para-evaluar-el-modelo" class="nav-link" data-scroll-target="#métricas-para-evaluar-el-modelo">Métricas para evaluar el modelo</a></li>
      <li><a href="#calcular-las-métricas" id="toc-calcular-las-métricas" class="nav-link" data-scroll-target="#calcular-las-métricas">Calcular las métricas</a></li>
      <li><a href="#área-bajo-la-curva" id="toc-área-bajo-la-curva" class="nav-link" data-scroll-target="#área-bajo-la-curva">Área bajo la curva</a></li>
      </ul></li>
      <li><a href="#capítulo-iii-travesía-hacia-el-modelo-arcano" id="toc-capítulo-iii-travesía-hacia-el-modelo-arcano" class="nav-link" data-scroll-target="#capítulo-iii-travesía-hacia-el-modelo-arcano">CAPÍTULO III: Travesía hacia el Modelo Arcano</a>
      <ul class="collapse">
      <li><a href="#árboles-de-decisión" id="toc-árboles-de-decisión" class="nav-link" data-scroll-target="#árboles-de-decisión">Árboles de decisión</a></li>
      <li><a href="#arbusto" id="toc-arbusto" class="nav-link" data-scroll-target="#arbusto">Arbusto</a></li>
      <li><a href="#árboles-de-clasificación-y-regresión-cart" id="toc-árboles-de-clasificación-y-regresión-cart" class="nav-link" data-scroll-target="#árboles-de-clasificación-y-regresión-cart">Árboles de clasificación y regresión (CART)</a></li>
      <li><a href="#cart-con-hiperparámetros" id="toc-cart-con-hiperparámetros" class="nav-link" data-scroll-target="#cart-con-hiperparámetros">CART con hiperparámetros</a></li>
      <li><a href="#pero-todo-esto-pasa-en-los-datos-de-prueba" id="toc-pero-todo-esto-pasa-en-los-datos-de-prueba" class="nav-link" data-scroll-target="#pero-todo-esto-pasa-en-los-datos-de-prueba">¡Pero todo esto pasa en los datos de prueba!</a></li>
      <li><a href="#por-qué-es-malo" id="toc-por-qué-es-malo" class="nav-link" data-scroll-target="#por-qué-es-malo">¿Por qué es malo?</a></li>
      <li><a href="#cómo-vamos-a-elegir-el-mejor-modelo-si-solo-podemos-evaluar-un-modelo-en-los-datos-de-prueba" id="toc-cómo-vamos-a-elegir-el-mejor-modelo-si-solo-podemos-evaluar-un-modelo-en-los-datos-de-prueba" class="nav-link" data-scroll-target="#cómo-vamos-a-elegir-el-mejor-modelo-si-solo-podemos-evaluar-un-modelo-en-los-datos-de-prueba">¿Cómo vamos a elegir el mejor modelo si solo podemos evaluar un modelo en los datos de prueba?</a></li>
      </ul></li>
      <li><a href="#capítulo-iv-los-senderos-de-la-validación-cruzada" id="toc-capítulo-iv-los-senderos-de-la-validación-cruzada" class="nav-link" data-scroll-target="#capítulo-iv-los-senderos-de-la-validación-cruzada">CAPÍTULO IV: Los Senderos de la Validación Cruzada</a>
      <ul class="collapse">
      <li><a href="#validación-cruzada" id="toc-validación-cruzada" class="nav-link" data-scroll-target="#validación-cruzada">Validación Cruzada</a></li>
      <li><a href="#cart-con-hiperparametros-y-validación-cruzada" id="toc-cart-con-hiperparametros-y-validación-cruzada" class="nav-link" data-scroll-target="#cart-con-hiperparametros-y-validación-cruzada">CART con hiperparametros y validación cruzada</a></li>
      <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest">Random Forest</a>
      <ul class="collapse">
      <li><a href="#random-forest-1" id="toc-random-forest-1" class="nav-link" data-scroll-target="#random-forest-1">Random Forest</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#capítulo-v-el-antiguo-conflicto-sesgo-contra-varianza" id="toc-capítulo-v-el-antiguo-conflicto-sesgo-contra-varianza" class="nav-link" data-scroll-target="#capítulo-v-el-antiguo-conflicto-sesgo-contra-varianza">CAPÍTULO V: El Antiguo Conflicto: Sesgo contra Varianza</a>
      <ul class="collapse">
      <li><a href="#sesgo-y-varianza" id="toc-sesgo-y-varianza" class="nav-link" data-scroll-target="#sesgo-y-varianza">Sesgo y varianza</a></li>
      <li><a href="#formas-de-disminur-el-sesgo" id="toc-formas-de-disminur-el-sesgo" class="nav-link" data-scroll-target="#formas-de-disminur-el-sesgo">Formas de disminur el sesgo</a></li>
      <li><a href="#técnicas-para-reducir-la-varianza" id="toc-técnicas-para-reducir-la-varianza" class="nav-link" data-scroll-target="#técnicas-para-reducir-la-varianza">Técnicas para reducir la varianza</a></li>
      </ul></li>
      <li><a href="#fin" id="toc-fin" class="nav-link" data-scroll-target="#fin">Fin</a></li>
      </ul>
    </nav>
    </div>
    <main class="content" id="quarto-document-content">
    
    <header id="title-block-header" class="quarto-title-block default">
    <div class="quarto-title">
    <h1 class="title">Resultados Pruebas Saber Pro Universidad Católica de Colombia 2022</h1>
    </div>
    
    
    <div class="quarto-title-meta-author">
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-heading">Affiliation</div>
      
        <div class="quarto-title-meta-contents">
        <p class="author">Omar J. González </p>
      </div>
        <div class="quarto-title-meta-contents">
            <p class="affiliation">
                Universdiad Católica de Colombia
              </p>
          </div>
        </div>
    
    <div class="quarto-title-meta">
    
          
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">November 8, 2023</p>
        </div>
      </div>
      
        
      </div>
      
    
    </header>
    
    <section id="toc-capítulo-i-Introducción" class="level1">
    <h1>CAPÍTULO I: Introducción</h1>
    <p>En el presente documento se elabora un análisis de los datos publicados en <b>Dataicfes</b> y los <b>Datos agrupados</b>,
        donde se expone una mirada a más profundidad de los resultados obtenidos por la Universidad y los diferentes programas.</p>
        
        <p>Como herramientas del procesamiento se utilizara <b>R</b> si el presente lector desea obtener el script y las bases utilizadas puede ponerse en contacto la coordinación de evaluación a los siguientes correos <i>"coordinacionevaluacion@ucatolica.edu.co"</i> o <i>"ojgonzalez@ucatolica.edu.co"</i>.</p>


    <section id="#Modelos-VA" class="level2">
    <h2 class="anchored" data-anchor-id="Modelos-VA">Los modelos de valor agregado</h2>
    <p>Hay muchas formas de estimar modelos de valor agregado, acá se utilizara inicialemente el modelo desarrollado por el ICFES</p>
    <ul>
    <li><code>lm(formula, data, ...)</code></li>
    <li><code>stan_glm(formula, data, family= "gaussian",...)</code></li>
    <li><code>glmnet(x=matrix, y=vector, family="gaussian",...)</code></li>
    </ul>
    <div class="callout callout-style-default callout-tip callout-titled">
    <div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Tip
    </div>
    <div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
    </div>
    <div id="callout-1" class="callout-1-contents callout-collapse collapse">
    <div class="callout-body-container callout-body">
    <p><code>lm()</code>: Ajusta un modelo de regresión lineal a los datos.</p>
    <p><code>stan_glm()</code>: Ajusta un modelo de regresión utilizando el paquete Stan.</p>
    <p><code>glmnet()</code>: Ajusta un modelo de regresión utilizando la regularización Lasso o Ridge.</p>
    </div>
    </div>
    </div>
    <p><a href="https://www.tidymodels.org/">Tidymodels</a> ofrece una sintaxis general para estimar los modelos</p>
    <ul>
    <li>Especificar el tipo de modelo
    <ul>
    <li>linear_reg(), logistic_reg(), decition_tree()</li>
    </ul></li>
    <li>Especificar el tipo de outcome
    <ul>
    <li>Regresión para outcomes continuos</li>
    <li>Clasificación: multinomial, ordinal, binaria</li>
    </ul></li>
    </ul>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
    <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code>Linear Regression Model Specification (regression)
    
    Computational engine: lm </code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
    <span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code>Linear Regression Model Specification (regression)
    
    Computational engine: glmnet </code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span></span>
    <span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code>Linear Regression Model Specification (regression)
    
    Computational engine: stan </code></pre>
    </div>
    </div>
    <div class="callout callout-style-default callout-tip callout-titled">
    <div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Tip
    </div>
    <div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
    </div>
    <div id="callout-2" class="callout-2-contents callout-collapse collapse">
    <div class="callout-body-container callout-body">
    <p><code>library()</code>: Carga el paquete tidymodels en R.</p>
    <p><code>tidymodels_prefer()</code>: Establece el paquete tidymodels como el preferido para las funciones de modelado en R.</p>
    <p><code>linear_reg()</code>: Crea una especificación de modelo de regresión lineal en el marco de trabajo tidymodels.</p>
    <p><code>set_engine()</code>: Establece el motor de cálculo para un objeto de especificación de modelo. Se establece en “lm” para la primera llamada a linear_reg(), “glmnet” para la segunda llamada y “stan” para la tercera.</p>
    </div>
    </div>
    </div>
    <p>Para estimar un modelo hay que hacer los siguientes pasos:</p>
    <section id="especificar-el-modelo" class="level3">
    <h3 class="anchored" data-anchor-id="especificar-el-modelo">1. Especificar el modelo</h3>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span></span>
    <span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span> </span>
    <span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"glm"</span>, <span class="at">family=</span><span class="st">"binomial"</span>) <span class="sc">|&gt;</span></span>
    <span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Especificar un modelo de regresión logística. Se establece el “paquete”, en este caso “glm” y opciones del paquete (la distribución de la variable de respuesta). Además, se establece el modo de modelado en “classification” para indicar que es una variable categórica. El resultado se almacena en el objeto <em>lm_model</em>.</p>
    </section>
    <section id="estimar-el-modelo" class="level3">
    <h3 class="anchored" data-anchor-id="estimar-el-modelo">2. Estimar el modelo</h3>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lm_results <span class="ot">&lt;-</span> lm_model <span class="sc">|&gt;</span></span>
    <span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(puntaje <span class="sc">~</span> ., <span class="at">data =</span> taller_icfes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Aquí se ajusta-estima el modelo utilizando la función <code>fit()</code>. Se especifica la variable de respuesta (puntaje) y los predictores (.) y se utiliza el objeto <em>taller_icfes</em> como base de datos.</p>
    </section>
    <section id="ver-los-resultados-del-modelo" class="level3">
    <h3 class="anchored" data-anchor-id="ver-los-resultados-del-modelo">3. Ver los resultados del modelo</h3>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lm_results <span class="sc">|&gt;</span> <span class="fu">tidy</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 49 × 5
       term                                     estimate std.error statistic p.value
       &lt;chr&gt;                                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
     1 (Intercept)                              -1.64       0.500    -3.28   1.03e-3
     2 fami_personashogar_9                     -0.243      0.0418   -5.82   5.73e-9
     3 fami_cuartoshogar_92                      0.100      0.161     0.622  5.34e-1
     4 fami_cuartoshogar_93                      0.230      0.162     1.42   1.56e-1
     5 fami_cuartoshogar_94                      0.209      0.178     1.18   2.38e-1
     6 fami_cuartoshogar_95                      0.287      0.224     1.28   1.99e-1
     7 fami_cuartoshogar_96                      0.0285     0.253     0.113  9.10e-1
     8 fami_educacionpadre_9No aplica            0.00678    0.158     0.0428 9.66e-1
     9 fami_educacionpadre_9Primaria            -0.149      0.0894   -1.67   9.57e-2
    10 fami_educacionpadre_9Técnico o Tecnólogo  0.555      0.0921    6.02   1.70e-9
    # ℹ 39 more rows</code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lm_results <span class="sc">|&gt;</span> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 8
      null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
              &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
    1         7781.    5888 -3420. 6938. 7265.    6840.        5840  5889</code></pre>
    </div>
    </div>
    <p><br></p>
    <ul>
    <li><p><code>tidy():</code> Esta función se utiliza para convertir los resultados de un modelo en un marco de datos “ordenado” que muestra los coeficientes del modelo, los errores estándar, los valores t y los valores p para cada variable independiente.</p></li>
    <li><p><code>glance():</code> Esta función se utiliza para resumir los resultados de un modelo como estadísticas globales del modelo, por ejemplo, R-cuadrado ajustado, el AIC y el BIC.</p></li>
    </ul>
    <p><br></p>
    <div class="callout callout-style-default callout-tip callout-titled">
    <div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Tip
    </div>
    <div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
    </div>
    <div id="callout-3" class="callout-3-contents callout-collapse collapse">
    <div class="callout-body-container callout-body">
    <div class="cell">
    <div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lm_results <span class="sc">|&gt;</span> <span class="fu">tidy</span>(<span class="at">exp=</span><span class="cn">TRUE</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 49 × 7
       term                  estimate std.error statistic p.value conf.low conf.high
       &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
     1 (Intercept)              0.194    0.500    -3.28   1.03e-3   0.0684     0.494
     2 fami_personashogar_9     0.784    0.0418   -5.82   5.73e-9   0.722      0.851
     3 fami_cuartoshogar_92     1.11     0.161     0.622  5.34e-1   0.809      1.52 
     4 fami_cuartoshogar_93     1.26     0.162     1.42   1.56e-1   0.919      1.74 
     5 fami_cuartoshogar_94     1.23     0.178     1.18   2.38e-1   0.873      1.75 
     6 fami_cuartoshogar_95     1.33     0.224     1.28   1.99e-1   0.860      2.07 
     7 fami_cuartoshogar_96     1.03     0.253     0.113  9.10e-1   0.626      1.69 
     8 fami_educacionpadre_…    1.01     0.158     0.0428 9.66e-1   0.736      1.37 
     9 fami_educacionpadre_…    0.862    0.0894   -1.67   9.57e-2   0.722      1.03 
    10 fami_educacionpadre_…    1.74     0.0921    6.02   1.70e-9   1.45       2.09 
    # ℹ 39 more rows</code></pre>
    </div>
    </div>
    <p><code>tidy(exp=TRUE, conf.int=TRUE)</code>: Esta función se utiliza para convertir los resultados de un modelo en un marco de datos “ordenado” que muestra los coeficientes del modelo, los errores estándar, los valores t y los valores p para cada variable independiente. Los argumentos exp y conf.int se utilizan para incluir los intervalos de confianza y los exponentes en los resultados</p>
    </div>
    </div>
    </div>
    </section>
    </section>
    </section>
    <section id="capítulo-ii-en-las-profundidades-de-los-datos" class="level1">
    <h1>CAPÍTULO II: En las Profundidades de los Datos</h1>
    <p>¿Para qué necesitamos los datos? los datos los necesitamos para</p>
    <ul>
    <li>Estimar valores<br>
    </li>
    <li>Seleccionar modelos</li>
    <li>Sintonizar los modelos (tunning)</li>
    <li>Evaluar los modelos</li>
    </ul>
    <p><em>¿Cómo podemos gastarnos los datos de una forma que sea eficiente para todos estos pasos?</em> (validación empírica)</p>
    <blockquote class="blockquote">
    <p>Primera idea: dividir los datos en dos grupos, unos datos para entrenar el modelo y otro para probarlo.</p>
    </blockquote>
    <section id="dividir-los-datos" class="level2">
    <h2 class="anchored" data-anchor-id="dividir-los-datos">Dividir los datos</h2>
    <ul>
    <li>Dividir los datos en dos conjuntos
    <ul>
    <li>Entrenamiento
    <ul>
    <li>La mayoría de los datos (¿70%, 80%?)</li>
    <li>Aquí se ajusta el modelo</li>
    </ul></li>
    <li>Prueba
    <ul>
    <li>Un pequeño conjunto de datos</li>
    <li>Aquí se evaluará el modelo final</li>
    </ul></li>
    </ul></li>
    </ul>
    <p>Los datos de prueba se utilizan una sola vez, si se utilizan más de una vez, se convierten en parte del proceso de entrenamiento.</p>
    <div class="callout callout-style-default callout-warning callout-titled">
    <div class="callout-header d-flex align-content-center">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Warning
    </div>
    </div>
    <div class="callout-body-container callout-body">
    <p>La división de los datos se hace al nivel de unidad independiente de observación.</p>
    <p>Evitar a toda costa la contaminación del los datos de prueba (information leakage), es decir, no se puede filtrar la información de una base a la otra.</p>
    </div>
    </div>
    <p>Entonces, uno puede crear dos bases de datos con por ejemplo 80% y 20% de los datos. Pero, ¿cómo se hace esto en R?</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
    <span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>datos_divididos <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(taller_icfes, <span class="at">prop =</span> <span class="fl">0.8</span>, <span class="at">strata =</span> <span class="st">"puntaje"</span>)</span>
    <span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>datos_entrenamiento <span class="ot">&lt;-</span> <span class="fu">training</span>(datos_divididos)</span>
    <span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>datos_prueba <span class="ot">&lt;-</span> <span class="fu">testing</span>(datos_divididos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>La opción <em>strata</em> es para que los datos de entrenamiento y prueba tengan la misma distribución de la variable <strong>puntaje</strong></p>
    <p>A veces la selección aleatoria de la muestra es problemática, por ejemplo cuando hay una componente de tiempo en los datos. En este caso, se puede usar la función <code>initial_time_split()</code>.</p>
    <div class="callout callout-style-default callout-tip callout-titled">
    <div class="callout-header d-flex align-content-center">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Tip
    </div>
    </div>
    <div class="callout-body-container callout-body">
    <p><code>set.seed()</code>: se utiliza para establecer una semilla para la generación de números aleatorios en R. En este caso, se utiliza para establecer la semilla en 1234, lo que garantiza que los resultados sean reproducibles. Esto es especialmente importante cuando se trabaja con modelos de aprendizaje automático, ya que los resultados pueden variar según la semilla utilizada para la generación de números aleatorios.</p>
    <p><code>initial_split()</code>: Esta función se utiliza para dividir un data frame o tibble en conjuntos de entrenamiento y prueba. En este caso, se utiliza para dividir el objeto “taller_icfes” en conjuntos de entrenamiento y prueba en una proporción de 80/20, y estratificando por la columna “puntaje”.</p>
    <p><code>training()</code>: Esta función se utiliza para extraer el conjunto de entrenamiento de un objeto creado con la función initial_split(). En este caso, se utiliza para extraer el conjunto de entrenamiento del objeto “datos_divididos”.</p>
    <p><code>testing()</code>: Esta función se utiliza para extraer el conjunto de prueba de un objeto creado con la función initial_split(). En este caso, se utiliza para extraer el conjunto de prueba del objeto “datos_divididos”.</p>
    </div>
    </div>
    <p>Ahora, podemos repetir la estimación del modelo anterior, pero solo vamos a necesitar los pasos 2 y 3.</p>
    </section>
    <section id="estimar-el-modelo-1" class="level2">
    <h2 class="anchored" data-anchor-id="estimar-el-modelo-1">2. Estimar el modelo</h2>
    <p>Estimación del modelo: Se utiliza la función <code>lm_model()</code> y <code>fit()</code> para ajustar un modelo de regresión lineal. La fórmula puntaje ~ . indica que se está modelando la variable puntaje como una función de todas las otras variables en el dataframe <strong>“datos_entrenamiento”</strong>.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lm_results <span class="ot">&lt;-</span> lm_model <span class="sc">|&gt;</span></span>
    <span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(puntaje <span class="sc">~</span> ., <span class="at">data =</span> datos_entrenamiento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    </section>
    <section id="visualizar-los-resultados-del-modelo" class="level2">
    <h2 class="anchored" data-anchor-id="visualizar-los-resultados-del-modelo">3. Visualizar los resultados del modelo</h2>
    <p><em>Visualizar los resultados del modelo:</em> Se utiliza la función tidy para obtener un resumen limpio y ordenado de los resultados del modelo. En el segundo uso de tidy, se exponencian los coeficientes y los intervalos de confianza.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>lm_results <span class="sc">|&gt;</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 49 × 5
       term                                     estimate std.error statistic p.value
       &lt;chr&gt;                                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
     1 (Intercept)                               -1.68      0.524    -3.21   1.31e-3
     2 fami_personashogar_9                      -0.261     0.0474   -5.50   3.76e-8
     3 fami_cuartoshogar_92                       0.197     0.186     1.06   2.90e-1
     4 fami_cuartoshogar_93                       0.358     0.187     1.91   5.62e-2
     5 fami_cuartoshogar_94                       0.332     0.205     1.62   1.05e-1
     6 fami_cuartoshogar_95                       0.485     0.255     1.90   5.74e-2
     7 fami_cuartoshogar_96                       0.117     0.286     0.411  6.81e-1
     8 fami_educacionpadre_9No aplica             0.0173    0.177     0.0979 9.22e-1
     9 fami_educacionpadre_9Primaria             -0.0868    0.0992   -0.875  3.81e-1
    10 fami_educacionpadre_9Técnico o Tecnólogo   0.574     0.103     5.57   2.54e-8
    # ℹ 39 more rows</code></pre>
    </div>
    </div>
    <p>Pero,</p>
    <p>¿Cómo sabemos que el modelo es bueno?</p>
    </section>
    <section id="evaluar-el-modelo" class="level2">
    <h2 class="anchored" data-anchor-id="evaluar-el-modelo">4. Evaluar el modelo</h2>
    <p><strong>Evaluación del modelo:</strong> se hace una “predicción” utilizando el modelo ajustado. Primero, se seleccionan algunos valores de <strong>datos_entrenamiento</strong> para predecir. Luego, se utiliza la función predict para obtener las predicciones del modelo. En el segundo uso de predict, se solicita la probabilidad de las predicciones.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>predecir_estos_valores <span class="ot">&lt;-</span> datos_entrenamiento <span class="sc">%&gt;%</span> </span>
    <span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>puntaje) <span class="sc">%&gt;%</span> </span>
    <span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
    <span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm_results, predecir_estos_valores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 10 × 1
       .pred_class
       &lt;fct&gt;      
     1 0          
     2 0          
     3 0          
     4 0          
     5 0          
     6 0          
     7 1          
     8 0          
     9 0          
    10 0          </code></pre>
    </div>
    </div>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm_results, predecir_estos_valores, <span class="at">type=</span><span class="st">"prob"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 10 × 2
       .pred_0 .pred_1
         &lt;dbl&gt;   &lt;dbl&gt;
     1   0.923  0.0766
     2   0.633  0.367 
     3   0.772  0.228 
     4   0.849  0.151 
     5   0.703  0.297 
     6   0.676  0.324 
     7   0.475  0.525 
     8   0.537  0.463 
     9   0.700  0.300 
    10   0.788  0.212 </code></pre>
    </div>
    </div>
    </section>
    <section id="predicción-en-el-conjunto-completo-de-datos" class="level2">
    <h2 class="anchored" data-anchor-id="predicción-en-el-conjunto-completo-de-datos">Predicción en el conjunto completo de datos</h2>
    <p>Ahora vamos a realizar una predicción en todo el conjunto de datos de entrenamiento y los vamos a unir con los datos de entrenamiento originales. Luego, vamos a seleccionar y reordenar las columnas.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>entrenamiento <span class="ot">&lt;-</span> datos_entrenamiento <span class="sc">%&gt;%</span> </span>
    <span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>puntaje)</span>
    <span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_results, entrenamiento)</span>
    <span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>resultados_prueba <span class="ot">&lt;-</span> <span class="fu">cbind</span>(prediccion, datos_entrenamiento) <span class="sc">|&gt;</span> </span>
    <span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.pred_class, puntaje, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
    <span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
    <span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>resultados_prueba  <span class="sc">|&gt;</span>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 10 × 16
       .pred_class puntaje fami_personashogar_9 fami_cuartoshogar_9
       &lt;fct&gt;       &lt;fct&gt;                  &lt;dbl&gt; &lt;chr&gt;              
     1 0           0                          5 4                  
     2 0           0                          3 3                  
     3 0           0                          4 4                  
     4 0           0                          4 3                  
     5 0           0                          5 5                  
     6 0           0                          5 3                  
     7 1           0                          3 3                  
     8 0           0                          4 4                  
     9 0           0                          3 2                  
    10 0           0                          3 3                  
    # ℹ 12 more variables: fami_educacionpadre_9 &lt;chr&gt;,
    #   fami_educacionmadre_9 &lt;chr&gt;, fami_tienecomputador_9 &lt;chr&gt;,
    #   fami_tienelavadora_9 &lt;chr&gt;, fami_tienehornomicroogas_9 &lt;chr&gt;,
    #   fami_tieneautomovil_9 &lt;chr&gt;, fami_tieneconsolavideojuegos_9 &lt;chr&gt;,
    #   fami_tieneinternet_9 &lt;chr&gt;, fami_tieneserviciotv_9 &lt;chr&gt;,
    #   fami_trabajolaborpadre_9 &lt;chr&gt;, fami_trabajolabormadre_9 &lt;chr&gt;,
    #   fami_numlibros_9 &lt;chr&gt;</code></pre>
    </div>
    </div>
    </section>
    <section id="métricas-para-evaluar-el-modelo" class="level2">
    <h2 class="anchored" data-anchor-id="métricas-para-evaluar-el-modelo">Métricas para evaluar el modelo</h2>
    <p><strong>Accuracy (Exactitud):</strong> Es una métrica que mide la proporción de predicciones correctas realizadas por un modelo en comparación con el total de predicciones realizadas. Es decir, la cantidad de veces que el modelo acertó sobre el total de datos que se le presentaron.</p>
    <p><strong>Sensitivity (Sensibilidad):</strong> Es la proporción de verdaderos positivos (TP) que son identificados correctamente por el modelo en relación con el total de verdaderos positivos y falsos negativos (FN). La sensibilidad mide la capacidad del modelo para detectar correctamente los casos positivos.</p>
    <p><strong>Specificity (Especificidad):</strong> Es la proporción de verdaderos negativos (TN) que son identificados correctamente por el modelo en relación con el total de verdaderos negativos y falsos positivos (FP). La especificidad mide la capacidad del modelo para detectar correctamente los casos negativos.</p>
    <p><strong>Precision (Precisión):</strong> Es la proporción de verdaderos positivos (TP) que son identificados correctamente por el modelo en relación con el total de verdaderos positivos y falsos positivos (FP). La precisión mide la capacidad del modelo para no identificar falsamente un caso como positivo.</p>
    <p><strong>Recall (Recuperación):</strong> Es la proporción de verdaderos positivos (TP) que son identificados correctamente por el modelo en relación con el total de verdaderos positivos y falsos negativos (FN). El recall mide la capacidad del modelo para identificar todos los casos positivos.</p>
    <p><strong>F-measure (Puntuación F):</strong> Es una métrica que combina la precisión y el recall en una sola puntuación. El valor de la F-measure oscila entre 0 y 1, siendo 1 el valor óptimo.</p>
    <p><strong>Kappa (Coeficiente Kappa):</strong> Es una medida de concordancia que compara la cantidad de acuerdos observados entre el modelo y las observaciones reales con la cantidad de acuerdos que se esperarían por casualidad. Un valor de kappa cercano a 1 indica una concordancia casi perfecta entre el modelo y las observaciones reales.</p>
    <p><strong>Matthews Correlation Coefficient (Coeficiente de Correlación de Matthews):</strong> Es una medida que se utiliza para evaluar la calidad de la clasificación binaria. El coeficiente de correlación de Matthews oscila entre -1 y 1, siendo 1 el valor óptimo. Un valor cercano a 1 indica una clasificación perfecta, mientras que un valor cercano a -1 indica una clasificación completamente incorrecta.</p>
    <p><img src="img/metrics.jpeg" class="img-fluid"></p>
    </section>
    <section id="calcular-las-métricas" class="level2">
    <h2 class="anchored" data-anchor-id="calcular-las-métricas">Calcular las métricas</h2>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_mat</span>(resultados_prueba, <span class="at">truth =</span> puntaje,</span>
    <span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">estimate =</span> .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code>          Truth
    Prediction    0    1
             0 2522  990
             1  430  768</code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(resultados_prueba, <span class="at">truth =</span> puntaje,</span>
    <span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">estimate =</span> .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 3
      .metric  .estimator .estimate
      &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
    1 accuracy binary         0.699</code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens</span>(resultados_prueba, <span class="at">truth =</span> puntaje,</span>
    <span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> .pred_class, </span>
    <span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 3
      .metric .estimator .estimate
      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
    1 sens    binary         0.437</code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span>(resultados_prueba, <span class="at">truth =</span> puntaje,</span>
    <span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> .pred_class, </span>
    <span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 3
      .metric .estimator .estimate
      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
    1 spec    binary         0.854</code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precision</span>(resultados_prueba, <span class="at">truth =</span> puntaje,</span>
    <span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 3
      .metric   .estimator .estimate
      &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
    1 precision binary         0.641</code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">recall</span>(resultados_prueba, <span class="at">truth =</span> puntaje,</span>
    <span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 3
      .metric .estimator .estimate
      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
    1 recall  binary         0.437</code></pre>
    </div>
    <div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kap</span>(resultados_prueba, <span class="at">truth =</span> puntaje,</span>
    <span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 3
      .metric .estimator .estimate
      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
    1 kap     binary         0.311</code></pre>
    </div>
    </div>
    <p>También se pueden calcular con menos repetición del código</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>custom_metrics <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(accuracy, sens, spec, precision, recall, f_meas, kap, mcc)</span>
    <span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_metrics</span>(resultados_prueba,</span>
    <span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> puntaje,</span>
    <span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">"second"</span></span>
    <span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 8 × 3
      .metric   .estimator .estimate
      &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
    1 accuracy  binary         0.699
    2 sens      binary         0.437
    3 spec      binary         0.854
    4 precision binary         0.641
    5 recall    binary         0.437
    6 f_meas    binary         0.520
    7 kap       binary         0.311
    8 mcc       binary         0.323</code></pre>
    </div>
    </div>
    <p>Y las podemos guardar en una tabla.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>lm_metrics <span class="ot">&lt;-</span> <span class="fu">custom_metrics</span>(resultados_prueba,</span>
    <span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> puntaje,</span>
    <span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">"second"</span></span>
    <span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
    <span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    </section>
    <section id="área-bajo-la-curva" class="level2">
    <h2 class="anchored" data-anchor-id="área-bajo-la-curva">Área bajo la curva</h2>
    <p>La función <code>roc_auc()</code> se utiliza para calcular el área bajo la curva (AUC) de la curva (ROC).</p>
    <p>La curva ROC es una representación gráfica de la sensibilidad frente a la especificidad para un sistema clasificador binario.</p>
    <p>El AUC es una métrica de rendimiento para los modelos de clasificación. Su valor varía de 0 a 1, donde un valor de 1 indica que el modelo tiene una capacidad de clasificación perfecta, mientras que un valor de 0.5 indica que el modelo no tiene capacidad de clasificación, es decir, clasifica al azar.</p>
    <p>En general, un modelo se considera bueno si el AUC es 0.7 o superior. Sin embargo, esto puede variar dependiendo del contexto y del problema específico que se esté abordando.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>prediccion_auc <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_results, entrenamiento, <span class="at">type =</span> <span class="st">"prob"</span>)</span>
    <span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>resultados_prueba_auc <span class="ot">&lt;-</span> <span class="fu">cbind</span>(prediccion_auc, datos_entrenamiento) <span class="sc">|&gt;</span></span>
    <span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
    <span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">roc_auc</span>(resultados_prueba_auc,</span>
    <span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> puntaje,</span>
    <span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">.pred_1</span><span class="st">`</span>,</span>
    <span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">"second"</span></span>
    <span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 1 × 3
      .metric .estimator .estimate
      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
    1 roc_auc binary         0.728</code></pre>
    </div>
    </div>
    <p>Y se puede crear una gráfica</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc_curve</span>(resultados_prueba_auc,</span>
    <span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="at">event_level =</span> <span class="st">"second"</span>,</span>
    <span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> puntaje,</span>
    <span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  .pred_1</span>
    <span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">autoplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output-display">
    <p><img src="taller-icfes_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
    </div>
    </div>
    <p>Ahora, ¿cómo podemos mejorar el modelo?</p>
    </section>
    </section>
    <section id="capítulo-iii-travesía-hacia-el-modelo-arcano" class="level1">
    <h1>CAPÍTULO III: Travesía hacia el Modelo Arcano</h1>
    <section id="árboles-de-decisión" class="level2">
    <h2 class="anchored" data-anchor-id="árboles-de-decisión">Árboles de decisión</h2>
    <p>Los árboles de decisión son un tipo de modelo de aprendizaje automático que se utiliza para resolver problemas de clasificación y regresión. El objetivo es tomar decisiones basadas en preguntas y respuestas que se hacen a los datos para llegar a una conclusión o predicción. En un árbol de decisión, cada punto o “nodo” representa una característica de los datos que estamos estudiando. Cada “rama” del árbol muestra una respuesta posible a esa característica.</p>
    <p><img src="img/tree.png" class="img-fluid"></p>
    </section>
    <section id="arbusto" class="level2">
    <h2 class="anchored" data-anchor-id="arbusto">Arbusto</h2>
    <p>Para estimar un árbol pequeño, hay que seguir los mismos pasos que para estimar un modelo de regresión logística, como hicimos anteriormente.</p>
    <ol type="1">
    <li><strong>Especificación del modelo:</strong> Se especifica un modelo de árbol de decisión con un parámetro de complejidad de 0. Se utiliza el paquete <code>rpart</code> y se establece el modo en classification.</li>
    </ol>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>tree_spec <span class="ot">&lt;-</span> </span>
    <span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>(<span class="at">cost_complexity=</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
    <span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">|&gt;</span> </span>
    <span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <ol start="2" type="1">
    <li><strong>Ajuste del modelo:</strong> Se ajusta el modelo de árbol de decisión utilizando la fórmula puntaje ~ ., lo que significa que se está modelando puntaje como una función de todas las otras variables en el dataframe taller_icfes.</li>
    </ol>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>tree_results <span class="ot">&lt;-</span> tree_spec <span class="sc">|&gt;</span></span>
    <span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(puntaje <span class="sc">~</span> ., <span class="at">data =</span> taller_icfes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <ol start="3" type="1">
    <li><strong>Visualización del árbol de decisión</strong>: Se extrae el modelo ajustado del resultado del ajuste y se visualiza utilizando la función tree_diagram del paquete treemisc.</li>
    </ol>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cart_tree_fit <span class="ot">&lt;-</span> tree_results<span class="sc">$</span>fit</span>
    <span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>treemisc<span class="sc">::</span><span class="fu">tree_diagram</span>(cart_tree_fit, <span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output-display">
    <p><img src="taller-icfes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
    </div>
    </div>
    <p>¿Cómo se decide por dónde cortar los datos en un árbol de decisión? <a href="https://mlu-explain.github.io/decision-tree/">ver esto</a></p>
    </section>
    <section id="árboles-de-clasificación-y-regresión-cart" class="level2">
    <h2 class="anchored" data-anchor-id="árboles-de-clasificación-y-regresión-cart">Árboles de clasificación y regresión (CART)</h2>
    <p>Ahora, que ya sabemos cómo se construye el árbol, utilicemos todos los datos.</p>
    <p>Paso 1. Especificar el modelo</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>tree_spec <span class="ot">&lt;-</span> </span>
    <span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span> </span>
    <span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
    <span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Paso 2. Estimar el modelo</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>tree_results <span class="ot">&lt;-</span> tree_spec <span class="sc">|&gt;</span></span>
    <span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(puntaje <span class="sc">~</span> ., <span class="at">data =</span> datos_entrenamiento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Ahora, vamos a pasar a evaluar el model.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>entrenamiento <span class="ot">&lt;-</span> datos_entrenamiento <span class="sc">%&gt;%</span></span>
    <span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>puntaje)</span>
    <span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>prediccion_tree <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree_results, entrenamiento)</span>
    <span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>resultados_prueba_tree <span class="ot">&lt;-</span> <span class="fu">cbind</span>(prediccion_tree, datos_entrenamiento) <span class="sc">|&gt;</span></span>
    <span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Y calculemos las métricas</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>tree_metrics <span class="ot">&lt;-</span> <span class="fu">custom_metrics</span>(resultados_prueba_tree,</span>
    <span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> puntaje,</span>
    <span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_class, </span>
    <span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level=</span> <span class="st">"second"</span></span>
    <span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
    <span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"tree"</span>)</span>
    <span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(tree_metrics, lm_metrics) <span class="sc">|&gt;</span></span>
    <span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> model, <span class="at">values_from =</span> .estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 8 × 4
      .metric   .estimator  tree    lm
      &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
    1 accuracy  binary     0.678 0.699
    2 sens      binary     0.296 0.437
    3 spec      binary     0.906 0.854
    4 precision binary     0.652 0.641
    5 recall    binary     0.296 0.437
    6 f_meas    binary     0.408 0.520
    7 kap       binary     0.227 0.311
    8 mcc       binary     0.261 0.323</code></pre>
    </div>
    </div>
    </section>
    <section id="cart-con-hiperparámetros" class="level2">
    <h2 class="anchored" data-anchor-id="cart-con-hiperparámetros">CART con hiperparámetros</h2>
    <p>Los hiperparámetros son valores específicos para los modelos que se pueden ajustar y que permiten controlar el proceso de entrenamiento de un modelo.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>tree_spec <span class="ot">&lt;-</span> </span>
    <span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>(<span class="at">min_n =</span> <span class="dv">5</span>, <span class="at">cost_complexity =</span> <span class="fl">0.001</span>) <span class="sc">|&gt;</span> </span>
    <span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
    <span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>En este caso, se están indicando dos hiperparámetros para el modelo de árbol de decisión:</p>
    <ul>
    <li><p>min_n: Es el número mínimo de observaciones que se requieren para dividir un nodo en un árbol de decisión. Un valor más alto de min_n implica que el árbol será menos profundo, ya que se requerirán más muestras para realizar una división en cada nodo.</p></li>
    <li><p>cost_complexity: Es un parámetro de regularización. Es una medida de la penalización que se aplica al árbol en función de su complejidad. Un valor más alto de cost_complexity implica una penalización más fuerte en la complejidad del árbol, lo que lleva a un árbol más pequeño y menos profundo.</p></li>
    </ul>
    <p>Ahora, a estimar el modelo</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tree2_results <span class="ot">&lt;-</span> tree_spec <span class="sc">|&gt;</span></span>
    <span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(puntaje <span class="sc">~</span> ., <span class="at">data =</span> datos_entrenamiento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Podemos obtener las predicciones</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>tree2_predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree2_results, entrenamiento)</span>
    <span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>resultados_prueba_tree2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tree2_predicciones, datos_entrenamiento) <span class="sc">|&gt;</span></span>
    <span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
    <span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>tree2_metrics <span class="ot">&lt;-</span> <span class="fu">custom_metrics</span>(resultados_prueba_tree2,</span>
    <span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> puntaje,</span>
    <span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">"second"</span></span>
    <span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
    <span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"tree2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Y finalmente, podemos comparar los modelos</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(tree2_metrics, tree_metrics, lm_metrics) <span class="sc">|&gt;</span></span>
    <span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> model, <span class="at">values_from =</span> .estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 8 × 5
      .metric   .estimator tree2  tree    lm
      &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1 accuracy  binary     0.773 0.678 0.699
    2 sens      binary     0.572 0.296 0.437
    3 spec      binary     0.892 0.906 0.854
    4 precision binary     0.760 0.652 0.641
    5 recall    binary     0.572 0.296 0.437
    6 f_meas    binary     0.653 0.408 0.520
    7 kap       binary     0.489 0.227 0.311
    8 mcc       binary     0.500 0.261 0.323</code></pre>
    </div>
    </div>
    </section>
    <section id="pero-todo-esto-pasa-en-los-datos-de-prueba" class="level2">
    <h2 class="anchored" data-anchor-id="pero-todo-esto-pasa-en-los-datos-de-prueba">¡Pero todo esto pasa en los datos de prueba!</h2>
    </section>
    <section id="por-qué-es-malo" class="level2">
    <h2 class="anchored" data-anchor-id="por-qué-es-malo">¿Por qué es malo?</h2>
    <p>Uno puede crear un modelo que tenga cerro error en los datos de prueba. Pero, ¿cómo sabemos que el modelo es bueno?</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar el valor del puntaje</span></span>
    <span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>datos_prueba2_out <span class="ot">&lt;-</span> </span>
    <span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  datos_prueba <span class="sc">|&gt;</span> </span>
    <span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(puntaje) </span>
    <span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizar los datos de prueba para predecir el puntaje utilizando el modelo de regresión logística  </span></span>
    <span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>lm_predicciones <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">predict</span>(lm_results, datos_prueba), datos_prueba2_out)<span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">"lm"</span>)</span>
    <span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizar los datos de prueba para predecir el puntaje utilizando el modelo de árbol de decisión</span></span>
    <span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>tree_predicciones <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">predict</span>(tree_results, datos_prueba), datos_prueba2_out)<span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">"tree"</span>)</span>
    <span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizar los datos de prueba para predecir el puntaje utilizando el modelo de árbol de decisión con hiperparámetros</span></span>
    <span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>tree2_predicciones <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">predict</span>(tree2_results, datos_prueba), datos_prueba2_out) <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">"tree2"</span>)</span>
    <span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Unir los resultados</span></span>
    <span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>all_models <span class="ot">&lt;-</span> </span>
    <span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(lm_predicciones, tree_predicciones, tree2_predicciones) </span>
    <span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="co"># all_models</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Finalmente, podemos comparar las métricas de los modelos.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>all_models2 <span class="ot">&lt;-</span> all_models <span class="sc">|&gt;</span> </span>
    <span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>(model) <span class="sc">%&gt;%</span></span>
    <span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">setNames</span>(<span class="fu">unique</span>(all_models<span class="sc">$</span>model)) <span class="sc">%&gt;%</span></span>
    <span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(., <span class="sc">~</span><span class="fu">custom_metrics</span>(.x,</span>
    <span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">truth =</span> puntaje,</span>
    <span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">estimate =</span> .pred_class), <span class="at">.id =</span> <span class="st">"names"</span>)</span>
    <span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>all_models2 <span class="sc">|&gt;</span> </span>
    <span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> names, <span class="at">values_from =</span> .estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 8 × 5
      .metric   .estimator    lm  tree tree2
      &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1 accuracy  binary     0.703 0.686 0.681
    2 sens      binary     0.869 0.926 0.827
    3 spec      binary     0.425 0.284 0.436
    4 precision binary     0.717 0.685 0.711
    5 recall    binary     0.869 0.926 0.827
    6 f_meas    binary     0.786 0.787 0.765
    7 kap       binary     0.316 0.238 0.279
    8 mcc       binary     0.332 0.282 0.286</code></pre>
    </div>
    </div>
    </section>
    <section id="cómo-vamos-a-elegir-el-mejor-modelo-si-solo-podemos-evaluar-un-modelo-en-los-datos-de-prueba" class="level2">
    <h2 class="anchored" data-anchor-id="cómo-vamos-a-elegir-el-mejor-modelo-si-solo-podemos-evaluar-un-modelo-en-los-datos-de-prueba">¿Cómo vamos a elegir el mejor modelo si solo podemos evaluar un modelo en los datos de prueba?</h2>
    <blockquote class="blockquote">
    <p>Segunda idea: dividir los datos de entrenamiento en dos grupos, uno para entrenar y otro para validar, de tal manera que podamos estimar el error del modelo en los datos de prueba.</p>
    </blockquote>
    </section>
    </section>
    <section id="capítulo-iv-los-senderos-de-la-validación-cruzada" class="level1">
    <h1>CAPÍTULO IV: Los Senderos de la Validación Cruzada</h1>
    <section id="validación-cruzada" class="level2">
    <h2 class="anchored" data-anchor-id="validación-cruzada">Validación Cruzada</h2>
    <p>Supongamos que estamos trabajando en un problema de clasificación y disponemos de un conjunto de datos con 1000 observaciones. Queremos evaluar el rendimiento de un modelo de regresión logística utilizando la validación cruzada k-fold.</p>
    <p>Paso a paso del proceso de k-fold cross-validation:</p>
    <p>Dividir el conjunto de datos: Primero, dividimos el conjunto de datos en k subconjuntos (folds) de igual tamaño. En este ejemplo, elegimos k=10, lo que significa que dividimos el conjunto de datos en 10 subconjuntos de 100 registros cada uno.</p>
    <p>Entrenar y evaluar el modelo: Luego, realizamos lo siguiente para cada uno de los k subconjuntos:</p>
    <ol type="a">
    <li><p>Tomamos un subconjunto como el conjunto de prueba (validación) y los k-1 subconjuntos restantes como el conjunto de entrenamiento. Por ejemplo, en la primera iteración, usamos el primer subconjunto como conjunto de prueba y los subconjuntos del 2 al 10 como conjunto de entrenamiento.</p></li>
    <li><p>Entrenamos el modelo de regresión logística utilizando el conjunto de entrenamiento.</p></li>
    <li><p>Evaluamos el rendimiento del modelo en el conjunto de prueba utilizando una métrica adecuada, como la precisión, la exhaustividad o el F1-score. Anotamos el resultado de la métrica para esta iteración.</p></li>
    </ol>
    <p>Promediar los resultados: Después de completar las k iteraciones, calculamos la media de los resultados de la métrica para todas las iteraciones. Esta media nos proporciona una estimación más robusta del rendimiento del modelo, ya que el modelo ha sido evaluado en diferentes subconjuntos del conjunto de datos.</p>
    <p><a href="https://scikit-learn.org/stable/modules/cross_validation.html">Más información aquí</a> y <a href="https://www.tmwr.org/resampling.html">aquí</a></p>
    </section>
    <section id="cart-con-hiperparametros-y-validación-cruzada" class="level2">
    <h2 class="anchored" data-anchor-id="cart-con-hiperparametros-y-validación-cruzada">CART con hiperparametros y validación cruzada</h2>
    <p>Lo primero que vamos a necesitar es crear un objecto en R que contenga los datos organizados de tal manera que podamos implementar la validación cruzada. Para esto, vamos a utilizar la función <code>vfold_cv()</code> del paquete <code>rsample</code>.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>crossvalidation <span class="ot">&lt;-</span></span>
    <span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vfold_cv</span>(datos_entrenamiento, </span>
    <span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">v =</span> <span class="dv">5</span>,  <span class="co"># número de cajas</span></span>
    <span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">strata =</span> <span class="st">"puntaje"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Ahora, vamos a especificar el modelo. Cuando se especifica un modelo de árbol de decisión, vamos a indicar que queremos que se prueben diferentes valores de los hiperparámetros “min_n” y “cost_complexity”. Para eso, vamos a utilizar el paquete <code>tune</code>.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>tree_spec <span class="ot">&lt;-</span> </span>
    <span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>(</span>
    <span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cost_complexity =</span> <span class="fu">tune</span>(), </span>
    <span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tree_depth =</span> <span class="fu">tune</span>(),</span>
    <span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_n =</span> <span class="fu">tune</span>()</span>
    <span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
    <span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
    <span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <div class="callout callout-style-default callout-tip callout-titled">
    <div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Tip
    </div>
    <div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
    </div>
    <div id="callout-6" class="callout-6-contents callout-collapse collapse">
    <div class="callout-body-container callout-body">
    <p><strong>Cost_complexity:</strong> Cost_complexity es un parámetro de regularización. Es una medida de la penalización que se aplica al árbol en función de su complejidad. Un valor más alto de cost_complexity implica una penalización más fuerte en la complejidad del árbol, lo que lleva a un árbol más pequeño y menos profundo. La idea es encontrar un valor óptimo de cost_complexity que equilibre la precisión y la complejidad del árbol, reduciendo tanto el sesgo como la varianza.</p>
    <p><strong>Tree_depth (profundidad del árbol)</strong>: Tree_depth se refiere a la longitud máxima del camino más largo desde la raíz hasta una hoja en un árbol de decisión. Un árbol más profundo es más complejo y puede capturar relaciones más complicadas en los datos. Sin embargo, un árbol demasiado profundo también puede ser propenso al sobreajuste, ya que puede adaptarse demasiado a las peculiaridades de los datos de entrenamiento.</p>
    <p><strong>min_n (mínimo número de muestras para dividir un nodo):</strong> Min_n es un parámetro que controla el número mínimo de datos requeridas para dividir un nodo en un árbol de decisión. Un valor más alto de min_n implica que el árbol será menos profundo, ya que se requerirán más muestras para realizar una división en cada nodo. Un valor más bajo de min_n permite que el árbol se divida más fácilmente y, por lo tanto, puede resultar en un árbol más complejo y profundo.</p>
    </div>
    </div>
    </div>
    <p>Ahora, vamos a especificar la rejilla de búsqueda. La rejilla de búsqueda es una tabla que contiene los valores que se van a probar para cada combinación de hiperparámetros.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>tree_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
    <span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cost_complexity</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span>10L, <span class="sc">-</span>1L)), </span>
    <span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tree_depth</span> (<span class="at">range =</span> <span class="fu">c</span>(4L, 7L)), </span>
    <span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min_n</span>(<span class="at">range =</span> <span class="fu">c</span>(10L, 30L)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>El siguiente paso es estimar el desempeño de los modelos en los datos de validación, utilizando los modelos creados con las diferentes combinaciones de hiperparámetros. Para esto, vamos a utilizar la función <code>tune_grid()</code> del paquete <code>tune</code>.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
    <span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
    <span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>tree_rs <span class="ot">&lt;-</span></span>
    <span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
    <span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    tree_spec,</span>
    <span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    puntaje <span class="sc">~</span> .,</span>
    <span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> crossvalidation,</span>
    <span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> tree_grid,</span>
    <span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, roc_auc, sensitivity, specificity)</span>
    <span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  )</span>
    <span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <div class="callout callout-style-default callout-tip callout-titled">
    <div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Tip
    </div>
    <div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
    </div>
    <div id="callout-7" class="callout-7-contents callout-collapse collapse">
    <div class="callout-body-container callout-body">
    <p><code>doParallel</code> es un excelente paquete creado para facilitar la programación paralela en R. Utilizar R en “paralelo” permite aprovechar la potencia de los computadores para ahorrar tiempo.</p>
    </div>
    </div>
    </div>
    <p>Esto nos va a dar una tabla con los resultados de cada modelo, y podemos pedir que nos muestre la combinación de hiperparámetros que tuvo el mejor desempeño.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(tree_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stderr">
    <pre><code>Warning: No value of `metric` was given; metric 'accuracy' will be used.</code></pre>
    </div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 5 × 9
      cost_complexity tree_depth min_n .metric  .estimator  mean     n std_err
                &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
    1    0.0000000001          4    10 accuracy binary     0.673     5 0.00434
    2    0.00000316            4    10 accuracy binary     0.673     5 0.00434
    3    0.0000000001          4    20 accuracy binary     0.673     5 0.00434
    4    0.00000316            4    20 accuracy binary     0.673     5 0.00434
    5    0.0000000001          4    30 accuracy binary     0.673     5 0.00434
    # ℹ 1 more variable: .config &lt;chr&gt;</code></pre>
    </div>
    </div>
    <p>Y podemos visualizar los resultados</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tree_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output-display">
    <p><img src="taller-icfes_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
    </div>
    </div>
    <p>Finalmente, podemos seleccionar el mejor modelo y estimarlo con los datos de entrenamiento.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>simpler_tree <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tree_rs, min_n, <span class="at">metric =</span> <span class="st">"accuracy"</span>)</span>
    <span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>final_tree <span class="ot">&lt;-</span> <span class="fu">finalize_model</span>(tree_spec, simpler_tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <div class="callout callout-style-default callout-tip callout-titled">
    <div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
    <div class="callout-icon-container">
    <i class="callout-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    Tip
    </div>
    <div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
    </div>
    <div id="callout-8" class="callout-8-contents callout-collapse collapse">
    <div class="callout-body-container callout-body">
    <p>La función <code>finalize_model</code> permite actualizar la especificación del modelo con los hiperparámetros seleccionados.</p>
    </div>
    </div>
    </div>
    <p>Ahora, volvemos a hacer lo que hemos estado haciendo: estimar el modelo con los datos de entrenamiento.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>final_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(final_tree, puntaje <span class="sc">~</span> ., datos_entrenamiento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Ya sabemos cómo evaluar el modelo, así que vamos a hacerlo. Para eso, vamos a utilizar la función <code>last_fit()</code>, que va a hacer un montón de trabajo por nosotros. Esta función va a estimar el modelo con los datos de entrenamiento y va a calcular las métricas de evaluación en los datos de entrenamiento y prueba.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>final_cart <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(final_tree, puntaje <span class="sc">~</span> ., datos_divididos,</span>
    <span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, roc_auc, sensitivity, specificity),</span>
    <span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">control_grid</span>(<span class="at">event_level =</span> <span class="st">"second"</span>)</span>
    <span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stderr">
    <pre><code>Warning: Unknown or uninitialised column: `.extracts`.</code></pre>
    </div>
    </div>
    <p>Y podemos recolectar las métricas</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(final_cart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 4 × 4
      .metric     .estimator .estimate .config             
      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
    1 accuracy    binary         0.683 Preprocessor1_Model1
    2 sensitivity binary         0.332 Preprocessor1_Model1
    3 specificity binary         0.892 Preprocessor1_Model1
    4 roc_auc     binary         0.632 Preprocessor1_Model1</code></pre>
    </div>
    </div>
    <p>¿Y podemos visualizar el árbol?</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>final_cart <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(final_tree, puntaje <span class="sc">~</span> ., datos_divididos,</span>
    <span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, roc_auc, sensitivity, specificity))</span>
    <span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>cart_trained <span class="ot">&lt;-</span> </span>
    <span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  final_cart  <span class="sc">|&gt;</span> <span class="fu">extract_fit_parsnip</span>()</span>
    <span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>cart_tree_fit <span class="ot">&lt;-</span> cart_trained<span class="sc">$</span>fit</span>
    <span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>treemisc<span class="sc">::</span><span class="fu">tree_diagram</span>(cart_tree_fit, <span class="at">roundint=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stderr">
    <pre><code>Warning: labs do not fit even at cex 0.15, there may be some overplotting</code></pre>
    </div>
    <div class="cell-output-display">
    <p><img src="taller-icfes_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
    </div>
    </div>
    <blockquote class="blockquote">
    <p>Extra idea: los árboles son muy buenos para aprender la distribuación de los datos de prueba, pero a veces, tienden a sobre especializarse en los datos en los que son entrenados. Una forma de solucionar esto, es hacer muchos árboles, que podamos después promediar.</p>
    </blockquote>
    </section>
    <section id="random-forest" class="level2">
    <h2 class="anchored" data-anchor-id="random-forest">Random Forest</h2>
    <p>Ya sabemos por qué es Forest, pero ¿por qué es random?</p>
    <ul>
    <li>Número de predictores que se usan para cada árbol (mtry)</li>
    <li>Número de observaciones por árbol</li>
    </ul>
    <section id="random-forest-1" class="level3">
    <h3 class="anchored" data-anchor-id="random-forest-1">Random Forest</h3>
    <p>Los pasos son los mismo, solo cambia la especificación del modelo.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>rf_spec <span class="ot">&lt;-</span> </span>
    <span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rand_forest</span>()  <span class="sc">|&gt;</span> </span>
    <span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
    <span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">importance =</span> <span class="st">"permutation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Hay algunos métodos para tratar de identificar cuáles fueron las variables más relevantes en el momento de hacer las mejores predicciones.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rf_results <span class="ot">&lt;-</span> rf_spec <span class="sc">|&gt;</span> </span>
    <span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fit</span>(puntaje <span class="sc">~</span> ., <span class="at">data =</span> datos_entrenamiento)</span>
    <span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
    <span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>importance_plot_rf <span class="ot">&lt;-</span> </span>
    <span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  rf_results <span class="sc">|&gt;</span> </span>
    <span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>() <span class="sc">+</span></span>
    <span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Random Forest"</span>) <span class="sc">+</span></span>
    <span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
    <span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, </span>
    <span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">color=</span><span class="st">"green"</span>, <span class="at">fill=</span><span class="st">"green"</span>, <span class="at">alpha=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Ahora, a recolectar métricas.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>rf_predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_results, entrenamiento)</span>
    <span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>resultados_rf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rf_predicciones,datos_entrenamiento) <span class="sc">|&gt;</span> </span>
    <span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
    <span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>rf_metrics <span class="ot">&lt;-</span> <span class="fu">custom_metrics</span>(resultados_rf,</span>
    <span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">truth =</span> puntaje,</span>
    <span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">event_level=</span> <span class="st">"second"</span>) <span class="sc">|&gt;</span></span>
    <span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">"rf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    </div>
    <p>Y a comparar los modelos</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(rf_metrics, tree2_metrics, tree_metrics, lm_metrics) <span class="sc">|&gt;</span> </span>
    <span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> model, <span class="at">values_from =</span> .estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 8 × 6
      .metric   .estimator    rf tree2  tree    lm
      &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1 accuracy  binary     0.868 0.773 0.678 0.699
    2 sens      binary     0.710 0.572 0.296 0.437
    3 spec      binary     0.962 0.892 0.906 0.854
    4 precision binary     0.918 0.760 0.652 0.641
    5 recall    binary     0.710 0.572 0.296 0.437
    6 f_meas    binary     0.801 0.653 0.408 0.520
    7 kap       binary     0.705 0.489 0.227 0.311
    8 mcc       binary     0.718 0.500 0.261 0.323</code></pre>
    </div>
    </div>
    <p>La ley es que los datos de prueba se utilizan solo una vez, pero los hemos utilizado muchas veces. Veamos por última vez, cómo se comportaron los modelos en la base de prueba.</p>
    <div class="cell">
    <div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>rf_predicciones <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">predict</span>(rf_results, datos_prueba), datos_prueba2_out) <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">"rf"</span>)</span>
    <span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>all_models <span class="ot">&lt;-</span> </span>
    <span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(lm_predicciones, rf_predicciones,tree_predicciones, tree2_predicciones) </span>
    <span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>all_models2 <span class="ot">&lt;-</span> all_models <span class="sc">|&gt;</span> </span>
    <span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>(model) <span class="sc">%&gt;%</span></span>
    <span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">setNames</span>(<span class="fu">unique</span>(all_models<span class="sc">$</span>model)) <span class="sc">%&gt;%</span></span>
    <span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(., <span class="sc">~</span><span class="fu">custom_metrics</span>(.x,</span>
    <span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">truth =</span> puntaje,</span>
    <span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">estimate =</span> .pred_class,</span>
    <span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">event_level=</span> <span class="st">"second"</span>), <span class="at">.id =</span> <span class="st">"names"</span>)</span>
    <span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>all_models2 <span class="sc">|&gt;</span> </span>
    <span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> names, <span class="at">values_from =</span> .estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-stdout">
    <pre><code># A tibble: 8 × 6
      .metric   .estimator    lm    rf  tree tree2
      &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1 accuracy  binary     0.703 0.688 0.686 0.681
    2 sens      binary     0.425 0.386 0.284 0.436
    3 spec      binary     0.869 0.867 0.926 0.827
    4 precision binary     0.658 0.634 0.694 0.6  
    5 recall    binary     0.425 0.386 0.284 0.436
    6 f_meas    binary     0.517 0.480 0.403 0.505
    7 kap       binary     0.316 0.276 0.238 0.279
    8 mcc       binary     0.332 0.293 0.282 0.286</code></pre>
    </div>
    </div>
    </section>
    </section>
    </section>
    <section id="capítulo-v-el-antiguo-conflicto-sesgo-contra-varianza" class="level1">
    <h1>CAPÍTULO V: El Antiguo Conflicto: Sesgo contra Varianza</h1>
    <section id="sesgo-y-varianza" class="level2">
    <h2 class="anchored" data-anchor-id="sesgo-y-varianza">Sesgo y varianza</h2>
    <p>Estos dos conceptos son cruciales para entender el equilibrio entre la complejidad del modelo y su capacidad para generalizar a nuevos datos.</p>
    <p>Sesgo (Bias): a. Definición: El sesgo es la diferencia entre la predicción promedio de nuestro modelo y el valor verdadero que intentamos predecir.El sesgo, en términos estadísticos, se refiere a la diferencia sistemática entre la esperanza (o promedio) de las estimaciones que produce un estimador y el valor real del parámetro que se desea estimar. Un modelo con alta varianza es muy sensible a pequeñas variaciones en los datos de entrenamiento, lo que puede resultar en un sobreajuste. Es decir, el modelo se ajusta muy bien a los datos de entrenamiento, pero tiene un rendimiento deficiente en datos no vistos o de prueba.</p>
    <ol start="2" type="a">
    <li>Ejemplo: Un modelo de regresión lineal simple podría tener un alto sesgo si los datos reales tienen una relación no lineal.</li>
    <li>Implicaciones: Un modelo con alto sesgo es demasiado simple y no captura la estructura subyacente de los datos. Esto conduce a un bajo rendimiento en el conjunto de entrenamiento y prueba.</li>
    </ol>
    <p>Varianza (Variance): a. Definición: La varianza es la cantidad de variabilidad en las predicciones del modelo para un dato. b. Ejemplo: Un modelo de árbol de decisión muy profundo podría tener alta varianza, ya que es muy sensible a pequeñas variaciones en los datos de entrenamiento. c.&nbsp;Implicaciones: Un modelo con alta varianza tiende a sobreajustarse a los datos de entrenamiento, lo que resulta en un buen rendimiento en el conjunto de entrenamiento pero un bajo rendimiento en el conjunto de prueba.</p>
    <p>El objetivo en Machine Learning es equilibrar el sesgo y la varianza para minimizar el error de predicción general en el modelo a. Objetivo: Encontrar un equilibrio entre sesgo y varianza que minimice el error total de predicción. b. Estrategias: Seleccionar un modelo con la complejidad adecuada, usar técnicas de regularización, y validar el modelo con conjuntos de datos de entrenamiento y prueba separados.</p>
    <blockquote class="blockquote">
    <p>Tercera idea: en Machine Learning todo se trata de encontrar el mejor balance entre el sesgo y la varianza del modelo.</p>
    </blockquote>
    </section>
    <section id="formas-de-disminur-el-sesgo" class="level2">
    <h2 class="anchored" data-anchor-id="formas-de-disminur-el-sesgo">Formas de disminur el sesgo</h2>
    <p>Aumentar la complejidad del modelo: Un modelo más complejo puede capturar mejor la estructura subyacente de los datos. Por ejemplo, en lugar de utilizar una regresión lineal simple, podrías probar una regresión polinomial o un modelo de árbol de decisión.</p>
    <p>Añadir más variables: A veces, el sesgo puede ser el resultado de no tener en cuenta variables importantes que influyen en la variable objetivo. Añadir más variables relevantes puede ayudar a reducir el sesgo del modelo.</p>
    <p>Utilizar técnicas de “ingeniería de predictores”: Transformar o combinar las variables existentes para crear nuevas características puede ayudar a capturar mejor la relación entre las variables de entrada y salida. Por ejemplo, si estás trabajando en un problema de predicción de precios de viviendas, podrías crear una nueva característica que represente la relación entre el tamaño de la casa y el número de habitaciones.</p>
    <p>Aumentar el tamaño del conjunto de datos: Si tu conjunto de datos es pequeño o no es representativo de la población general, es posible que el modelo tenga un sesgo alto. Aumentar el tamaño del conjunto de datos y asegurarte de que es representativo puede ayudar a reducir el sesgo.</p>
    <p>Utilizar ensembles de modelos: Combinar varios modelos en un ensemble puede ayudar a reducir el sesgo, ya que cada modelo puede capturar diferentes aspectos de la relación entre las variables de entrada y salida. Por ejemplo, puedes utilizar métodos de ensemble como Bagging, Boosting o Stacking.</p>
    </section>
    <section id="técnicas-para-reducir-la-varianza" class="level2">
    <h2 class="anchored" data-anchor-id="técnicas-para-reducir-la-varianza">Técnicas para reducir la varianza</h2>
    <p>Reducir la complejidad del modelo: Un modelo más simple tiende a tener una menor varianza y es menos propenso al sobreajuste. Por ejemplo, podrías limitar la profundidad de un árbol de decisión.</p>
    <p>Utilizar regularización: La regularización es una técnica que añade una penalización a los coeficientes del modelo para evitar que se ajusten demasiado a los datos de entrenamiento.Por ejemplo, regularización L1 (Lasso) y L2 (Ridge).</p>
    <p>Aumentar el tamaño del conjunto de datos: Si dispones de más datos, el modelo será menos sensible a pequeñas variaciones en los datos de entrenamiento y tendrá una menor varianza.</p>
    <p>Eliminar características ruidosas: Si tu modelo incluye características que no están relacionadas con la variable objetivo o que contienen mucho ruido, estas pueden aumentar la varianza del modelo. Realizar un análisis de importancia de características y eliminar las características poco importantes puede ayudar a reducir la varianza.</p>
    <p>Validación cruzada (cross-validation): Utilizar la validación cruzada, como k-fold cross-validation, te permite evaluar el rendimiento del modelo en diferentes subconjuntos del conjunto de datos de entrenamiento. Esto puede ayudarte a identificar si el modelo está sobreajustando los datos y ajustar la complejidad del modelo en consecuencia.</p>
    <p>Utilizar diferentes modelos: Combinar varios modelos en un ensemble puede ayudar a reducir la varianza, ya que la variabilidad de cada modelo individual se promedia. Por ejemplo, puedes utilizar métodos de ensemble como Bagging (Bootstrap Aggregating) o Random Forest, que promedian las predicciones de múltiples árboles de decisión entrenados en subconjuntos aleatorios de los datos.</p>
    </section>
    </section>
    <section id="fin" class="level1">
    <h1>Fin</h1>
    </section>
    
    </main>
    <!-- /main column -->
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const icon = "";
      const anchorJS = new window.AnchorJS();
      anchorJS.options = {
        placement: 'right',
        icon: icon
      };
      anchorJS.add('.anchored');
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'bottom-start'
        };
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
          // Attach click handler to the DT
          const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
          for (const annoteDlNode of annoteDls) {
            annoteDlNode.addEventListener('click', (event) => {
              const clickedEl = event.target;
              if (clickedEl !== selectedAnnoteEl) {
                unselectCodeLines();
                const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
                if (activeEl) {
                  activeEl.classList.remove('code-annotation-active');
                }
                selectCodeLines(clickedEl);
                clickedEl.classList.add('code-annotation-active');
              } else {
                // Unselect the line
                unselectCodeLines();
                clickedEl.classList.remove('code-annotation-active');
              }
            });
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    </div> <!-- /content -->
    
    
    
    </body></html>